# Sample Log Resources

This document lists valuable resources for obtaining sample logs and templates for the log-simulator project.

## Official Vendor Resources

### Splunk

**Official Repositories:**
- **[splunk/attack_data](https://github.com/splunk/attack_data)** - Curated datasets from various attacks (9GB+ of data)
  - Security-focused attack datasets
  - Uses Git LFS for large files
  - Perfect for testing detection rules

- **[tmartin14/splunk-sample-data](https://github.com/tmartin14/splunk-sample-data)** - Community sample data collection
  - Includes Splunk app for easy ingestion
  - Creates "sampledata" index automatically
  - Various log types and formats

- **[splunk/botsv4](https://github.com/splunk/botsv4)** - Boss of the SOC v4 dataset
  - Realistic enterprise security dataset
  - Based on capture-the-flag scenarios
  - Includes multiple log sources

**Educational Resources:**
- **[0xrajneesh/Splunk-Projects-For-Beginners](https://github.com/0xrajneesh/Splunk-Projects-For-Beginners)**
  - SSH, DNS, FTP, HTTP, SMTP logs
  - Structured learning projects
  - Step-by-step analysis guides

### Elastic (ECS Format)

**ECS Logging Libraries:**
- **[elastic/ecs-logging](https://github.com/elastic/ecs-logging)** - Common resources for ECS loggers
- **[elastic/ecs-logging-python](https://github.com/elastic/ecs-logging-python)** - Python ECS logger
- **[elastic/ecs-logging-nodejs](https://github.com/elastic/ecs-logging-nodejs)** - Node.js ECS logger
- **[elastic/ecs-logging-java](https://github.com/elastic/ecs-logging-java)** - Java ECS logger
- **[elastic/ecs-logging-php](https://github.com/elastic/ecs-logging-php)** - PHP ECS logger
- **[elastic/ecs-logging-ruby](https://github.com/elastic/ecs-logging-ruby)** - Ruby ECS logger

**Sample Data Generators:**
- **[elastic/makelogs](https://github.com/elastic/makelogs)** - Fake HTTP traffic log generator
  - Push sample logs to Elasticsearch
  - Node.js-based generator
  - Good for testing ELK stack

**Examples:**
- **[ELK Stack Apache Logs](https://gist.github.com/k4yt3x/fc304acaacadfc3e4159f7250524b04f)** - Sample Apache logs for ELK
- **[ECS Structured Logging Example](https://github.com/buingoctruong/ecs-structured-logging)** - Sample implementation

### Security Onion

**Log Formats:**
- Bro/Zeek IDS logs (JSON and tab-delimited)
- Snort/Suricata alerts
- Windows Event Logs (Sysmon)
- Standard syslog, CEF, LEF formats

**Test Data Generation:**
- Recommended: Use Atomic Red Team for realistic attack simulations
- Sample files: conn-sample.log (Bro IDS format)
- Supports Windows, Linux, macOS logs

## Cloud Provider Samples

### AWS CloudTrail
- **Official Docs**: https://docs.aws.amazon.com/cloudtrail/
- Sample logs available in AWS documentation
- JSON format
- Free tier available for testing

### Azure Activity Logs
- **Official Docs**: https://learn.microsoft.com/en-us/azure/
- Download from Azure Portal (JSON/CSV)
- Microsoft Graph API examples
- Free tier available

### Google Cloud Audit Logs
- **Official Docs**: https://cloud.google.com/logging/docs/audit/
- Cloud Logging format
- JSON structured logs
- Free tier available

### Google Workspace
- **Official Docs**: https://developers.google.com/admin-sdk/reports
- Reports API v1
- JSON format with activity events
- Trial accounts available

## Security-Focused Datasets

### MITRE ATT&CK Related

**Atomic Red Team:**
- **Repository**: https://github.com/redcanaryco/atomic-red-team
- Mapped to MITRE ATT&CK framework
- ~1,750 individual tests
- Generates real logs from simulated attacks
- **Our Strategy**: Use ART to generate CrowdStrike and other EDR logs

**Security Datasets:**
- **[splunk/attack_data](https://github.com/splunk/attack_data)** - Attack datasets
- **[OSSEM Project](https://github.com/OTRF/OSSEM)** - Open Source Security Events Metadata
- **[The Cyber Threat Framework (CTF)](https://github.com/center-for-threat-informed-defense/attack-flow)**

## Web Server Logs

### Nginx
- Default format: Combined log format
- JSON support via log_format directive
- Sample configs widely available
- Can generate locally easily

### Apache
- Common/Combined log format
- mod_log_config for custom formats
- Extensive examples online
- Can generate locally easily

## CrowdStrike Falcon

**Official Resources:**
- **Developer Portal**: https://developer.crowdstrike.com/
- Falcon Data Replicator (FDR) - JSON format
- FDR Schema API for schema definitions
- **Access**: Requires customer/partner credentials

**Alternative Approach:**
- Use Atomic Red Team to generate logs in sandboxed environment
- Execute tests with CrowdStrike agent installed
- Capture FDR events generated by tests
- Map to MITRE ATT&CK techniques

## Microsoft 365 / Office 365

**Official Resources:**
- **Unified Audit Log**: PowerShell `Search-UnifiedAuditLog`
- **Management Activity API Schema**: Official schema docs
- **Microsoft Graph API**: `/auditLogs/signIns`, `/auditLogs/directoryAudits`
- Trial accounts available for testing

## Strategy for log-simulator

### Phase 1: Easy Wins
1. ✅ Use public documentation examples (Google Workspace, Azure AD)
2. ✅ Generate web server logs locally (Nginx, Apache)
3. ✅ Use free tier cloud accounts for samples

### Phase 2: Community Resources
1. Clone Splunk attack_data repository
2. Use Elastic makelogs for ECS examples
3. Parse OSSEM for event schemas

### Phase 3: Atomic Red Team Integration
1. Set up sandboxed test environment
2. Install target security tools (CrowdStrike, etc.)
3. Execute ART tests
4. Capture and catalog generated logs
5. Create templates from real outputs

### Phase 4: Template Library
1. Organize collected samples by category
2. Anonymize/sanitize sensitive data
3. Create schema definitions from samples
4. Map to MITRE ATT&CK where applicable

## Next Steps

1. **Clone key repositories**:
   ```bash
   git clone https://github.com/splunk/attack_data
   git clone https://github.com/elastic/makelogs
   git clone https://github.com/redcanaryco/atomic-red-team
   ```

2. **Set up free tier accounts** for cloud providers

3. **Extract samples** from public documentation

4. **Create template collection** in `src/log_simulator/templates/`

5. **Document sources** for each template (licensing/attribution)

## License Considerations

- **Splunk attack_data**: Apache 2.0
- **Elastic repositories**: Apache 2.0 or Elastic License
- **Atomic Red Team**: MIT License
- **Cloud provider samples**: Check terms of service
- **Always attribute sources** and respect licensing

---

**Last Updated**: 2025-11-16
